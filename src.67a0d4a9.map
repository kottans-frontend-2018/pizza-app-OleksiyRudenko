{"version":3,"sources":["Component\\Component.js","Component\\index.js","utils\\dom.js","utils\\object.js","utils\\url.js","services\\API\\API.js","services\\API\\index.js","services\\Auth\\Auth.js","services\\Auth\\index.js","components\\Router\\Router.js","components\\Router\\index.js","components\\Layout\\Layout.js","components\\Layout\\index.js","components\\Login\\Login.js","components\\Login\\index.js","components\\Logout\\Logout.js","components\\Logout\\index.js","components\\Register\\Register.js","components\\Register\\index.js","components\\Secret\\Secret.js","components\\Secret\\index.js","components\\Order\\Order.js","components\\Order\\index.js","components\\Orders\\Orders.js","components\\Orders\\index.js","components\\PizzaParams\\PizzaParams.js","components\\PizzaParams\\index.js","services\\PizzaImagery\\PizzaImagery.js","services\\PizzaImagery\\index.js","components\\PizzaCanvas\\settings.js","components\\PizzaCanvas\\PizzaCanvas.js","components\\PizzaCanvas\\index.js","components\\PizzaEditor\\PizzaEditor.js","components\\PizzaEditor\\index.js","routes.js","index.js"],"names":["ComponentBase","props","console","log","name","state","host","nextState","Object","assign","renderedHost","_render","updateChildrenState","nextProps","children","render","innerHTML","Array","isArray","append","constructor","default","createElement","options","tag","String","element","document","id","classList","forEach","add","className","attr","keys","setAttribute","key","appendChild","child","toDOM","string","onReady","fragment","createDocumentFragment","helperElement","trim","iterativeRenderer","firstChild","setTimeout","setChildren","node","_setChildren","from","clearChildren","hasChildNodes","removeChild","lastChild","cloneNodeAs","deep","cloneNode","bindHandlers","context","methodNames","bind","Error","DOMMutationObserver","window","MutationObserver","WebKitMutationObserver","map","obj","fn","OBJECT_FIND_RESULT_VALUE_ONLY","OBJECT_FIND_RESULT_KEYVALUE","find","resultMode","entries","value","result","isObject","data","undefined","filter","item","URL_PARAM_REGEXP","urlToRegexp","RegExp","url","replace","isMatchingPath","template","test","containsUrlParams","path","extractUrlParams","params","values","split","reduce","acc","param","idx","slice","APIService","endPoint","assetBase","length","APIOwner","_get","then","success","list","registrationData","username","password","password_repeat","email","store_id","store_password","_post","loginData","_setToken","token","offset","limit","pizzaProps","description","size","ingredients","JSON","toString","tags","image","resource","isAuthRequired","urlParams","URLSearchParams","_getToken","Promise","reject","error","_request","headers","_headers","body","stringify","method","_makeUrl","toUpperCase","fetch","contentType","response","get","contentTypeIsJSON","includes","ok","status","statusText","json","catch","rejection","serverError","headersData","authorization","Headers","accept","localStorage","getItem","removeItem","setItem","API","AuthService","cache","login","logout","createUser","getStoreList","getIngredientList","results","resolve","getTagList","Auth","dom","Obj","Url","Router","routes","defaultRoute","currentRoute","currentPath","previousRoute","previousRestrictedRoute","activeComponent","layoutManager","navigateToRoute","addEventListener","handleUrlChange","nextRoute","onEnter","handleOnEnter","redirectToRoute","redirectUnauthorizedToRoute","isAuthorized","redirectAuthorizedToRoute","navigateOnSuccessToRoute","navigateOnSuccessToMethod","accum","routeName","component","routeProps","layout","updateState","mainComponent","location","hash","message","messageClass","navigateToUrl","rendered","Layout","prerendered","preRender","main","container","mainSection","Login","handleSubmitAction","register","Math","random","substring","ev","preventDefault","target","elements","resultMessage","els","getElementById","elId","el","focus","type","classToAdd","classToRemove","resultMessageElement","remove","Logout","handleLogoutAction","Register","handleDefaultSubmitAction","handlePasswordsMatch","handleRealSubmitAction","storeSelectElement","sort","a","b","option","text","errorUIelement","enableSubmission","checkValidity","submitButton","removeAttribute","pwd1","pwd2","setCustomValidity","click","reportValidity","fields","join","parseInt","password1","password2","validations","Secret","links","search","floor","Order","Orders","PIZZA_SIZES","PizzaParams","trackedParams","doUpdate","checked","onParamsChange","handleUserAction","handleSubmit","checkedSizeValue","_getPizzaSizeCheckedArray","pizzaSizeRadios","html","sets","all","getIngredients","getTags","i","checkedSize","PizzaImageryService","images","loadIngredients","push","Image","crossOrigin","src","prependAssetUrl","imageName","image_url","PizzaImagery","CANVAS","px","width","height","inch","pxInch","ingredient","areas","maxRadius","nodes","maxIngredients","center","x","y","r","round","targetR","radii","itemsOnCircle","PI","degStep","deg","pair","asimuth","inches","PizzaCanvas","ctx","getContext","clearRect","drawPizzaBase","drawIngredients","area","ingredientsCount","_distributeNodesEvenly","getImage","coordSet","polar","_drawImage","count","groupedNodes","len","times","ceil","j","pxDimension","azimuth","dx","dy","realCoordinates","_polar2carthesian","drawImage","radians","cos","sin","PizzaEditor","pizzaInitialState","pizzaCanvas","canvas","pizzaConstructor","canvasContainer","none","home","orders","order","secret","routingConfig","rootHost","getAttribute","router"],"mappings":"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","file":"src.67a0d4a9.map","sourcesContent":["/**\r\n * View component.\r\n * Rendering target expected at this.host, which is to be supplied by a parent component / calling context.\r\n * The workflow:\r\n * 1. Set up component (this.host|state|props}\r\n * 2. Do job or bind handlers\r\n * 3. At operational methods call {@link updateState} with object containing properties to change\r\n * {@link updateState} updates state and calls {@link _render}\r\n * {@link _render} calls overridden {@link render) and replaces this.hist.innerHTML with result from render()\r\n *\r\n * {@link render} will create HTMLElement|HTMLElement[]|DocumentFragment|string and may manage children components:\r\n * - call and embed children[].render() or\r\n * - children[].updateState()\r\n */\r\nexport default class ComponentBase {\r\n  /**\r\n   * Initializes a component with props\r\n   * @param {object} props\r\n   */\r\n  constructor(props) {\r\n    console.log('ComponentBase->' + this.name + '.constructor():in with props', props);\r\n    this.props = props || {};\r\n    this.state = props.state || {};\r\n    this.host = props.host || null;\r\n    console.log('ComponentBase->' + this.name + '.constructor():out returning nothing');\r\n  }\r\n\r\n  /**\r\n   * Updates component's state. Internal method.\r\n   * @param {object} nextState - state delta\r\n   */\r\n  updateState(nextState = {}) {\r\n    console.log('ComponentBase->' + this.name + '.updateState():in with nextState', nextState);\r\n    this.state = Object.assign({}, this.state, nextState);\r\n    const renderedHost = this._render();\r\n    this.updateChildrenState();\r\n    console.log('ComponentBase->' + this.name + '.updateState():out returning', renderedHost);\r\n    return renderedHost;\r\n  }\r\n\r\n  /**\r\n   * Updates component with props and call real render method from outside.\r\n   * @param {object} nextProps\r\n   * @returns {HTMLElement} this.host\r\n   */\r\n  update(nextProps) {\r\n    console.log('ComponentBase->' + this.name + '.update():in with nextProps', nextProps);\r\n    this.props = Object.assign(this.props, nextProps);\r\n    this.host = nextProps.host || this.host;\r\n    const renderedHost = this._render();\r\n    console.log('ComponentBase->' + this.name + '.update():out returning renderResult', renderedHost);\r\n    return renderedHost;\r\n  }\r\n\r\n  /**\r\n   * Real render method. Updates host content with a custom render method results.\r\n   * Custom render result may feed string or an array of strings|nodes or a node\r\n   * @returns {HTMLElement} this.host\r\n   * @private\r\n   */\r\n  _render() {\r\n    console.log('ComponentBase->' + this.name + '._render():in');\r\n    const children = this.render();\r\n    this.host.innerHTML = '';\r\n    if (typeof children === 'string') {\r\n      this.host.innerHTML = children;\r\n    } else if (Array.isArray(children)) {\r\n      this.host.append(...children);\r\n    } else {\r\n      this.host.append(children);\r\n    }\r\n    console.log('ComponentBase->' + this.name + '._render():out returning this.host', this.host);\r\n    return this.host;\r\n  }\r\n\r\n  /**\r\n   * Abstract method. Shall be implemented in custom component.\r\n   * Expected to return a set of Nodes|HTMLElements|string to be assigned to this.host.innerHTML or attached to this.host\r\n   * @override\r\n   */\r\n  render() {\r\n    console.log('ComponentBase->' + this.name + '.render():in');\r\n    console.log('ComponentBase->' + this.name + '.render():out returning \"\"');\r\n    return '';\r\n  }\r\n\r\n  /**\r\n   * Abstract method. Shall be implemented in custom component.\r\n   * Expected to return a set of Nodes|HTMLElements|string to be assigned to this.host.innerHTML or attached to this.host\r\n   * @override\r\n   */\r\n  updateChildrenState() {\r\n    console.log('ComponentBase->' + this.name + '.updateChildrenState():in');\r\n    console.log('ComponentBase->' + this.name + '.updateChildrenState():out returning nothing');\r\n  }\r\n\r\n  /**\r\n   * Returns class name.\r\n   */\r\n  get name() {\r\n    return this.constructor.name;\r\n  }\r\n}\r\n","export { default as default } from './Component.js';\r\n","/**\r\n * Callback for manipulating Node entry key and value.\r\n *\r\n * @callback onNodeReady\r\n * @param {Node} node\r\n */\r\n\r\n/**\r\n * Creates an HTML element\r\n * @param {object} options\r\n * @returns {HTMLElement}\r\n *\r\n * options: { tag:string,\r\n *            id:string,\r\n *            classList:string|[...string],\r\n *            attr: {attr-name:attr-value},\r\n *            children:HTMLElement|[...HTMLElement]\r\n *            innerHTML:string }\r\n */\r\nexport const createElement = function(options={tag:'div'}) {\r\n  if (!options) options = 'div';\r\n  if (typeof options === 'string' || options instanceof String) {\r\n    options = { tag: options };\r\n  }\r\n  if (!options.tag) {\r\n    options.tag = 'div';\r\n  }\r\n  const element = document.createElement(options.tag);\r\n  if (!!options.id) element.id = options.id;\r\n  if (!!options.classList) {\r\n    if (typeof options.classList === 'string' || options.classList instanceof String) {\r\n      options.classList = [ options.classList ];\r\n    }\r\n    options.classList.forEach(className => { element.classList.add(className);});\r\n  }\r\n  if (!!options.attr) {\r\n    Object.keys(options.attr).forEach(key => {\r\n      element.setAttribute(key, options.attr[key]);\r\n    });\r\n  }\r\n  if (!!options.innerHTML) {\r\n    element.innerHTML = options.innerHTML;\r\n  }\r\n  if (!!options.children) {\r\n    if (!Array.isArray(options.children)) options.children = [options.children];\r\n    options.children.forEach(child => {\r\n      element.appendChild(child);\r\n    });\r\n  }\r\n  return element;\r\n};\r\n\r\n/**\r\n * Renders DOM structure from string\r\n * @param {string} string\r\n * @param {onNodeReady} onReady to call when elements from string are rendered\r\n */\r\nexport const toDOM = (string, onReady) => {\r\n  const fragment = document.createDocumentFragment();\r\n  const helperElement = document.createElement('div');\r\n  // console.log('toDOM()');\r\n  helperElement.innerHTML = string.trim();\r\n  (function iterativeRenderer(){\r\n    if (helperElement.firstChild){\r\n      // Array.from(helperElement.childNodes).forEach(el => fragment.appendChild(el));\r\n      fragment.appendChild(helperElement.firstChild);\r\n      setTimeout(iterativeRenderer, 0); // arguments.callee\r\n    } else {\r\n      // console.log(helperElement);\r\n      // console.log(fragment);\r\n      onReady && onReady(fragment);\r\n    }\r\n  })();\r\n  // return fragment;\r\n};\r\n\r\n/**\r\n * Reassigns children to the node\r\n * @param {Node} node\r\n * @param {string|HTMLCollection|Node|[Node...]|DocumentFragment} children\r\n * @param {onNodeReady} onReady to call when elements from string are rendered\r\n */\r\nexport const setChildren = (node, children, onReady = null) => {\r\n  if (typeof children === 'string') {\r\n    toDOM(children, fragment => _setChildren(node, fragment, onReady));\r\n  } else {\r\n    _setChildren(node, children, onReady);\r\n  }\r\n};\r\n\r\n/**\r\n * Reassigns children to the node. String not accepted!\r\n * @param {Node} node\r\n * @param {HTMLCollection|Node|[Node...]|DocumentFragment} children\r\n * @param {onNodeReady} onReady to call when elements appended\r\n */\r\nexport const _setChildren = (node, children, onReady = null) => {\r\n  if (children === '[object HTMLCollection]') {\r\n    children = Array.from(children);\r\n  }\r\n  node = clearChildren(node);\r\n  if (Array.isArray(children)) {\r\n    children.forEach(child => typeof child === 'string' ? toDOM(child, fragment => node.appendChild(fragment)) : node.appendChild(child));\r\n  } else {\r\n    node.appendChild(children);\r\n  }\r\n  onReady && onReady(node);\r\n};\r\n\r\n/**\r\n * Clears node children\r\n * @param {Node} node\r\n * @returns {Node}\r\n */\r\nexport const clearChildren = node => {\r\n  // node.innerHTML = '';\r\n  while (node.hasChildNodes()) {\r\n    node.removeChild(node.lastChild);\r\n  }\r\n  return node;\r\n};\r\n\r\n/**\r\n * Clones element reassigning id\r\n * @param {HTMLElement} node\r\n * @param {string} id\r\n * @param {boolean=true} deep\r\n * @returns {Node}\r\n */\r\nexport const cloneNodeAs = function(node, id, deep = true) {\r\n  const element = node.cloneNode(deep);\r\n  element.id = id;\r\n  return element;\r\n};\r\n\r\n/**\r\n * Binds methods by their names to a given context.\r\n * @param {Object} context\r\n * @param {...methodNames} method names to bind\r\n */\r\nexport const bindHandlers = (context, ...methodNames) => {\r\n  methodNames.forEach(name => {\r\n    if (typeof context[name] === 'function') {\r\n      context[name] = context[name].bind(context);\r\n    } else {\r\n      throw Error(\r\n        `dom-utils.bindHandlers() expected function ${name}. Received ${typeof context[name]} instead.`\r\n      );\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * DOM mutation observer. Used when some element gets updated via .innerHTML.\r\n * Usage:\r\n * const observer = new DOMMutationObserver(function(mutationsList){}); // register a callback to invoke upon mutation\r\n * const config = {attributes: true, childList: true};\r\n * observer.observe(targetNode, config);\r\n * observer.disconnect(); // Stop observing when not required anymore\r\n * // https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver\r\n */\r\nexport const DOMMutationObserver =  window.MutationObserver || window.WebKitMutationObserver;\r\n","/**\r\n * Callback for manipulating object entry key and value.\r\n *\r\n * @callback manipulateObjectEntry\r\n * @param {string} value - entry value\r\n * @param {string} key - entry key\r\n */\r\n\r\n/**\r\n * Array.map style shallow object mapping\r\n * @param {object} obj\r\n * @param {manipulateObjectEntry} fn (value, key)\r\n * @returns {array}\r\n */\r\nexport const map = function(obj, fn) {\r\n  return Object.keys(obj).map(key => fn(obj[key], key));\r\n};\r\n\r\nexport const OBJECT_FIND_RESULT_VALUE_ONLY = false;\r\nexport const OBJECT_FIND_RESULT_KEYVALUE = true;\r\n/**\r\n * Callback for testing object entry based on its key and/or value.\r\n *\r\n * @callback testObjectEntry\r\n * @param {string} value - entry value\r\n * @param {string} key - entry key\r\n * @returns {boolean}\r\n */\r\n/**\r\n * Array.find style shallow object search\r\n * @param {object} obj\r\n * @param {testObjectEntry} fn (value, key)\r\n * @param {boolean|string} resultMode\r\n * @returns {*} undefined if not found\r\n *\r\n * Result mode explained.\r\n * Source Object may contain references to objects or other types\r\n * e.g. { key0: {...}, key1: 5, key2: [...] })\r\n *\r\n * resultMode:\r\n * - OBJECT_FIND_RESULT_VALUE_ONLY - will return found value only if any\r\n * - OBJECT_FIND_RESULT_KEYVALUE - will return { keyX: ... } for valid test if any\r\n * - arbitrary scalar value {number|string} - will return either of:\r\n *   - if value is object than it will be added with a {returnMode_Value: key}\r\n *   - otherwise value will be embedded into an object {returnMode_Value: key, data: value}\r\n */\r\nexport const find = function(obj, fn, resultMode = OBJECT_FIND_RESULT_VALUE_ONLY) {\r\n  for (let [key, value] of Object.entries(obj)) {\r\n    if (fn(value, key)) {\r\n      if (resultMode === OBJECT_FIND_RESULT_VALUE_ONLY) return value;\r\n      if (resultMode === OBJECT_FIND_RESULT_KEYVALUE) {\r\n        let result = {};\r\n        result[key] = value;\r\n        return result;\r\n      }\r\n      // we've got a scalar to use as a key identifier\r\n      if (!isObject(value)) {\r\n        value = { data: value };\r\n      }\r\n      value[resultMode] = key;\r\n      return value;\r\n    }\r\n  }\r\n  return undefined;\r\n};\r\n\r\n/**\r\n * Array.filter style shallow object filtering\r\n * @param {object} obj\r\n * @param {testObjectEntry} fn (value, key)\r\n * @returns {object} empty if neither key-value passes the test\r\n */\r\nexport const filter = function(obj, fn) {\r\n  let result = {};\r\n  for (let [key, value] of Object.entries(obj)) {\r\n    if (fn(value, key)) {\r\n      result[key] = value;\r\n    }\r\n  }\r\n  return result;\r\n};\r\n\r\n/**\r\n * Checks if item is an Object (and not also an Array or null).\r\n * @param item\r\n * @returns {boolean}\r\n */\r\nexport const isObject = item => typeof item === \"object\" && !Array.isArray(item) && item !== null;\r\n","/* Templated url methods */\r\n\r\nexport const URL_PARAM_REGEXP = /(:[^\\/]+)/g;\r\nconst urlToRegexp = url => RegExp(`^${url.replace(URL_PARAM_REGEXP, '([^/]+)')}$`);\r\n\r\nexport const isMatchingPath = (template, url) => {\r\n  template = urlToRegexp(template);\r\n  // console.log('Match ' + template + ' vs ' + url + ' = ' + template.test(url));\r\n  return template.test(url);\r\n};\r\n\r\nexport const containsUrlParams = path => URL_PARAM_REGEXP.test(path);\r\n\r\nexport const extractUrlParams = (template, url) => {\r\n  const params = {};\r\n  const values = url.split('/');\r\n  if (!values) {\r\n    return params;\r\n  }\r\n  return template.split('/').reduce((acc, param, idx) => {\r\n    if (!containsUrlParams(param)) {\r\n      return acc;\r\n    }\r\n    acc[param.slice(1)] = values[idx];\r\n    return acc;\r\n  }, params);\r\n};\r\n","class APIService {\r\n  constructor({endPoint, assetBase}) {\r\n    if (endPoint.length && endPoint[endPoint.length-1]!=='/') endPoint += '/';\r\n    this.endPoint = endPoint;\r\n    this.assetBase = assetBase;\r\n    this.APIOwner = 'https://github.com/lempiy/Kottans-Pizza-Api/';\r\n  }\r\n\r\n  // ====== API methods\r\n\r\n  // ------ STORE\r\n  /**\r\n   * Get store list via API\r\n   * @returns {Promise<{success: boolean, list: []}>}\r\n   */\r\n  getStoreList() {\r\n    return this._get('store/list', false).then(result => {\r\n      console.log('API.getStoreList(): responded', result);\r\n      return {\r\n        success: true,\r\n        list: result,\r\n      };\r\n    });\r\n  }\r\n\r\n  // ------ USERS\r\n  /**\r\n   * Creates user via API\r\n   * @param {object} registrationData\r\n   * @returns {Promise}\r\n   */\r\n  createUser(registrationData = {}) {\r\n    registrationData = Object.assign({\r\n      username: null,\r\n      password: null,\r\n      password_repeat: null,\r\n      email: null,\r\n      store_id: 0,\r\n      store_password: null,\r\n    }, registrationData);\r\n    console.log('API.createUser() request for', registrationData);\r\n    return this._post('user/create', registrationData, false).then(result => {\r\n      console.log('API.createUser(): responded', result);\r\n      return result;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Gets and stores auth token on success via API\r\n   * @param {object} loginData\r\n   * @returns {Promise}\r\n   */\r\n  login(loginData = {}) {\r\n    loginData = Object.assign({\r\n      username: null,\r\n      password: null,\r\n    }, loginData);\r\n    return this._post('user/login', loginData, false).then(result => {\r\n      this._setToken(result.token);\r\n      console.log('API.login(): responded', result);\r\n      return result;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Gets current user info via API\r\n   * @returns {Promise<{success: boolean}>}\r\n   */\r\n  getUserInfo() {\r\n    return this._get('user/my_info').then(result => {\r\n      console.log('API.getUserInfo(): responded', result);\r\n      return Object.assign({\r\n        success: true,\r\n      }, result)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Removes current token\r\n   */\r\n  logout() {\r\n    this._setToken(null);\r\n  }\r\n\r\n  // ------ PIZZA\r\n  /**\r\n   * Gets pizza list via API\r\n   * @param {object} params - url params\r\n   * @returns {Promise<{success: boolean}>}\r\n   */\r\n  getPizzaList(params = {}) {\r\n    params = Object.assign({\r\n      offset: 0,\r\n      limit: 100,\r\n    }, params);\r\n    return this._get('pizza/list',params).then(result => {\r\n      console.log('API.getPizzaList(): responded', result);\r\n      return Object.assign({\r\n        success: true\r\n      }, result);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates pizza via API\r\n   * @param {object} pizzaProps\r\n   * @returns {Promise}\r\n   */\r\n  createPizza(pizzaProps = {}) {\r\n    pizzaProps = Object.assign({\r\n      name: null,\r\n      description: null,\r\n      size: 30,\r\n      ingredients: JSON.toString([]),\r\n      tags: JSON.toString([]),\r\n      image: null,\r\n    }, pizzaProps);\r\n    return this._post('pizza/create',pizzaProps).then(result => {\r\n      console.log('API.createPizza(): responded', result);\r\n      return result;\r\n    });\r\n  }\r\n\r\n  // ------ INGREDIENT\r\n  /**\r\n   * Gets ingredients list via API\r\n   * @param {object} params - url params\r\n   * @returns {Promise<{success: boolean}>}\r\n   */\r\n  getIngredientList(params = {}) {\r\n    params = Object.assign({\r\n      offset: 0,\r\n      limit: 100,\r\n    }, params);\r\n    return this._get('ingredient/list',params).then(result => {\r\n      console.log('API.getIngredientList(): responded', result);\r\n      return Object.assign({\r\n        success: true\r\n      }, result);\r\n    });\r\n  }\r\n\r\n  // ------ TAG\r\n  /**\r\n   * Gets tags list via API\r\n   * @param {object} params - url params\r\n   * @returns {Promise<{success: boolean}>}\r\n   */\r\n  getTagList(params = {}) {\r\n    params = Object.assign({\r\n      offset: 0,\r\n      limit: 100,\r\n    }, params);\r\n    return this._get('tag/list',params).then(result => {\r\n      console.log('API.getTagList(): responded', result);\r\n      return Object.assign({\r\n        success: true\r\n      }, result);\r\n    });\r\n  }\r\n\r\n  // ------ Assets\r\n  prependAssetUrl(url) {\r\n    return this.assetBase + url;\r\n  }\r\n\r\n  // ====== Core private methods\r\n\r\n  /**\r\n   * Makes GET request via API\r\n   * @param {string} resource - partial resource\r\n   * @param {object} params - url parameters\r\n   * @param {boolean} isAuthRequired\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _get(resource, params = {}, isAuthRequired = true) {\r\n    if (typeof(params) === typeof(true)) {\r\n      isAuthRequired = params;\r\n      params = {};\r\n    }\r\n    const urlParams = new URLSearchParams();\r\n    Object.keys(params).forEach(key => {urlParams.append(key, params[key])});\r\n    if (urlParams.toString().length) {\r\n      resource += '?' + urlParams;\r\n    }\r\n    return (isAuthRequired && !this._getToken()) ? Promise.reject({\r\n      success: false,\r\n      error: 'Authorization required',\r\n    }) : this._request('get', resource, {\r\n      headers: this._headers({}, isAuthRequired)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Makes POST request via API\r\n   * @param {string} resource\r\n   * @param {*} data\r\n   * @param {boolean} isAuthRequired\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _post(resource, data, isAuthRequired = true) {\r\n    return (isAuthRequired && !this._getToken()) ? Promise.reject({\r\n      success: false,\r\n      error: 'Authorization required',\r\n    }) : this._request('post', resource, {\r\n      body: JSON.stringify(data),\r\n      headers: this._headers({}, isAuthRequired),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Makes an API call\r\n   * @param {string} method\r\n   * @param {string} resource\r\n   * @param {object} params\r\n   * @returns {Promise}\r\n   * @private\r\n   */\r\n  _request(method, resource, params = {}) {\r\n    const url = this._makeUrl(resource);\r\n    params = Object.assign({\r\n      /* cache: 'no-cache',              // *default, no-cache, reload, force-cache, only-if-cached\r\n      credentials: 'same-origin',     // include, same-origin, *omit */\r\n      method: method.toUpperCase(),   // *GET, POST, PUT, DELETE, etc.\r\n      /* mode: 'cors',                   // no-cors, cors, *same-origin\r\n      redirect: 'follow',             // *manual, follow, error\r\n      referrer: 'client',             // *client, no-referrer */\r\n    }, params);\r\n    console.log('API._request: requested', url, params);\r\n    return fetch(url, params).then(response => {\r\n      const contentType = response.headers.get(\"content-type\");\r\n      const contentTypeIsJSON = !!(contentType && contentType.includes(\"application/json\"));\r\n      console.log('API._request: responded', response);\r\n      if (!response.ok) {\r\n        console.log('API._request: NOT OK', response.status, response.statusText);\r\n        if (contentTypeIsJSON) {\r\n          return response.json().then(json => Promise.reject(json));\r\n        } else throw {\r\n          success: false,\r\n          error: response.status + ': ' + response.statusText,\r\n        };\r\n      }\r\n      return contentTypeIsJSON ? response.json() : response;\r\n    }).catch(rejection => {\r\n      console.log('API._request: rejection Before', rejection);\r\n      // Error => {success:false, error:'...'}\r\n      if (rejection.success !== false) {\r\n        rejection = {\r\n          success: false,\r\n          serverError: true,\r\n          error: rejection,\r\n        };\r\n      }\r\n      console.log('API._request: rejection', rejection);\r\n      throw rejection;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Compiles request headers\r\n   * @param {object} headersData\r\n   * @param {boolean} isAuthRequired\r\n   * @returns {Headers}\r\n   * @private\r\n   */\r\n  _headers(headersData = {}, isAuthRequired = true) {\r\n    if (isAuthRequired) {\r\n      headersData.authorization = headersData.authorization || `Bearer ${this._getToken()}`;\r\n    }\r\n    const headers = new Headers();\r\n    headersData = Object.assign({\r\n      accept: 'application/json',\r\n    }, headersData);\r\n    Object.keys(headersData).forEach(key => {\r\n      headers.append(key, headersData[key]);\r\n    });\r\n    return headers;\r\n  }\r\n\r\n  /**\r\n   * Makes complete request url\r\n   * @param {string} resource\r\n   * @returns {string}\r\n   * @private\r\n   */\r\n  _makeUrl(resource) {\r\n    return this.endPoint + resource;\r\n  }\r\n\r\n  _getToken() {\r\n    return window.localStorage.getItem('token');\r\n  }\r\n\r\n  _setToken(value = null) {\r\n    if (value === null) {\r\n      window.localStorage.removeItem('token');\r\n    } else {\r\n      window.localStorage.setItem('token',value);\r\n    }\r\n    return value;\r\n  }\r\n}\r\n\r\nexport const API = new APIService({\r\n  endPoint: 'https://pizza-tele.ga/api/v1/',\r\n  assetBase: 'https://pizza-tele.ga/',\r\n});\r\n","export { API } from './API.js';\r\n","import {API} from '../API';\r\n\r\nclass AuthService {\r\n  constructor() {\r\n    this.cache = {\r\n      tags: [],\r\n      ingredients: [],\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Returns promise for user login success\r\n   * @param username\r\n   * @param password\r\n   * @returns {*|Promise|{name, url, component, navigateOnSuccessToRoute, routes}}\r\n   */\r\n  login(username, password) {\r\n    return API.login({\r\n      username,\r\n      password,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Logs current user out\r\n   */\r\n  logout() {\r\n    API.logout();\r\n  }\r\n\r\n  /**\r\n   * Returns promise for user creation success\r\n   * @param username\r\n   * @param password\r\n   * @param password_repeat\r\n   * @param email\r\n   * @param store_id\r\n   * @param store_password\r\n   * @returns {Promise<any>}\r\n   */\r\n  register(username, password, password_repeat, email, store_id, store_password) {\r\n    return API.createUser({\r\n      username,\r\n      password,\r\n      password_repeat,\r\n      email,\r\n      store_id,\r\n      store_password\r\n    }).catch(rejection => Promise.reject(rejection)); // .then(result => result).catch(rejection => Promise.reject(rejection));\r\n  }\r\n\r\n  /**\r\n   * Returns promise for a store list object\r\n   * @returns {*|Promise<{success: boolean, list: *[]}>}\r\n   */\r\n  getStoreList() {\r\n    return API.getStoreList();\r\n  }\r\n\r\n  /**\r\n   * Returns promise for and array of ingredient objects\r\n   * @returns {Promise}\r\n   */\r\n  getIngredients() {\r\n    if (this.cache.ingredients.length === 0) {\r\n      return API.getIngredientList().then(data => this.cache.ingredients = data.results).catch(rejection => []);\r\n    }\r\n    return Promise.resolve(this.cache.ingredients);\r\n  }\r\n\r\n  /**\r\n   * Returns promise for an array of tag objects\r\n   * @returns {Promise}\r\n   */\r\n  getTags() {\r\n    if (this.cache.tags.length === 0) {\r\n      return API.getTagList().then(data => this.cache.tags = data.results).catch(rejection => []);\r\n    }\r\n    return Promise.resolve(this.cache.tags);\r\n  }\r\n\r\n  /**\r\n   * Returns authorization status\r\n   * @returns {boolean}\r\n   */\r\n  isAuthorized() {\r\n    return !!API._getToken();\r\n  }\r\n}\r\n\r\nexport const Auth = new AuthService();\r\n","export { Auth } from './Auth.js';\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport * as Obj from '../../utils/object.js';\r\nimport * as Url from '../../utils/url.js';\r\nimport {Auth} from '../../services/Auth';\r\n\r\n/**\r\n * Class representing app router.\r\n */\r\nexport default class Router extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      routes: props.routes,\r\n      defaultRoute: props.defaultRoute,\r\n      currentRoute: null,\r\n      currentPath: null,\r\n      previousRoute: null,\r\n      previousRestrictedRoute: null,\r\n      activeComponent: null,\r\n    };\r\n    this.layoutManager = props.layoutManager;\r\n    console.log('Router:');\r\n    console.log(props);\r\n    dom.bindHandlers(this, 'handleUrlChange', 'navigateToUrl', 'navigateToRoute');\r\n    if (!this.path) {\r\n      this.navigateToRoute('home');\r\n    }\r\n    window.addEventListener('hashchange', () => {\r\n      this.handleUrlChange(this.path);\r\n    });\r\n    this.handleUrlChange(this.path);\r\n  }\r\n\r\n  /**\r\n   * Returns hashed path\r\n   * @returns {string}\r\n   */\r\n  get path() {\r\n    console.log('Router get path:');\r\n    console.log(window.location.hash.slice(1));\r\n    return window.location.hash.slice(1);\r\n  }\r\n\r\n  /**\r\n   * Handles url change\r\n   * @param {string} path\r\n   */\r\n  handleUrlChange(path) {\r\n    const { routes, currentRoute, currentPath } = this.state;\r\n    console.log('Router handleUrlChange:');\r\n    /* console.log(this.props);\r\n    console.log(this.state); */\r\n    console.log(routes);\r\n\r\n    let nextRoute = Obj.find(routes, ({url}) => Url.isMatchingPath(url, path) );\r\n    if (!nextRoute) nextRoute = this.state.routes[this.state.defaultRoute];\r\n    console.log(nextRoute);\r\n    if (!!nextRoute && (nextRoute !== currentRoute || currentPath !== path )) {\r\n      if (nextRoute.onEnter) {\r\n        this.handleOnEnter(nextRoute);\r\n      }\r\n      if (nextRoute.redirectToRoute) {\r\n        this.navigateToRoute(nextRoute.redirectToRoute);\r\n        return;\r\n      }\r\n      if (nextRoute.redirectUnauthorizedToRoute && !Auth.isAuthorized()) {\r\n        this.navigateToRoute(nextRoute.redirectUnauthorizedToRoute);\r\n        return;\r\n      }\r\n      if (nextRoute.redirectAuthorizedToRoute && Auth.isAuthorized()) {\r\n        this.navigateToRoute(nextRoute.redirectAuthorizedToRoute);\r\n        return;\r\n      }\r\n      console.log(nextRoute);\r\n      const params = Url.extractUrlParams(nextRoute.url, path);\r\n      if (nextRoute.navigateOnSuccessToRoute) {\r\n        nextRoute.navigateOnSuccessToMethod = this.navigateToRoute;\r\n      }\r\n      if (nextRoute.routes && Array.isArray(nextRoute.routes)) nextRoute.routes = nextRoute.routes.reduce((accum, routeName) => {\r\n        accum[routeName] = {\r\n          name: this.state.routes[routeName].name,\r\n          url: this.state.routes[routeName].url,\r\n        };\r\n        return accum;\r\n      }, {});\r\n\r\n      const activeComponent = new nextRoute.component({\r\n        host: this.host,\r\n        routeProps: nextRoute,\r\n        params: params,\r\n      });\r\n\r\n      if (nextRoute.layout) {\r\n        this.layoutManager.updateState({\r\n          mainComponent: activeComponent,\r\n        });\r\n      }\r\n\r\n      this.updateState({\r\n        activeComponent: activeComponent,\r\n        currentRoute: nextRoute,\r\n        currentPath: path,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Navigate to a given url\r\n   * @param {string} url\r\n   */\r\n  navigateToUrl(url) {\r\n    window.location.hash = url;\r\n  }\r\n\r\n  /**\r\n   * Navigate to a given route. Puts past route on history\r\n   * @param {string} routeName name\r\n   * @param {string} message - optional message that target route component may use\r\n   * @param {string} messageClass - optional message class (e.g. alert or success)\r\n   */\r\n  navigateToRoute(routeName, message = null, messageClass = null) {\r\n    if (this.state.currentRoute) {\r\n      this.state.previousRoute = this.state.currentRoute;\r\n      // next may be used by such features like Login to bring user back to the point he was rejected from\r\n      if (this.state.currentRoute.redirectUnauthorizedToRoute) {\r\n        this.previousRestrictedRoute = this.state.currentRoute;\r\n      }\r\n    }\r\n    this.navigateToUrl(this.state.routes[routeName].url);\r\n  }\r\n\r\n  /**\r\n   * Handles on component enter event. E.g. check permissions\r\n   * @param {function} onEnter\r\n   */\r\n  handleOnEnter({ onEnter }) {\r\n    onEnter();\r\n  }\r\n\r\n  /**\r\n   * Render routing\r\n   * @returns {*|HTMLElement|string}\r\n   */\r\n  render() {\r\n    console.log(this.name + '.render()', this.state);\r\n    const { activeComponent, currentRoute } = this.state;\r\n    const layoutManager = this.layoutManager;\r\n    /*\r\n    const rendered = currentRoute.layout ? layoutManager.updateState({\r\n      mainComponent: activeComponent,\r\n    }) : activeComponent && activeComponent.render(); */\r\n    const rendered = currentRoute.layout ? layoutManager.render() : activeComponent && activeComponent.render();\r\n    console.log(this.name + '.render() out with', rendered);\r\n    return rendered;\r\n  }\r\n\r\n}\r\n","import mod from './Router.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport './style.css';\r\n\r\n/**\r\n * Class representing page layout.\r\n */\r\nexport default class Layout extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.prerendered = this.preRender();\r\n    console.log('Layout: ', this.props);\r\n  }\r\n\r\n  updateChildrenState() {\r\n    console.log(this.name +'.updateChildrenState() in having this.state.mainComponent', this.state.mainComponent);\r\n    this.state.mainComponent.host = this.prerendered.main;\r\n    this.state.mainComponent.updateState();\r\n    console.log(this.name +'.updateChildrenState() out returning nothing');\r\n  }\r\n\r\n  /**\r\n   * Renders component view.\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    return this.prerendered.fragment;\r\n  }\r\n\r\n  /**\r\n   * PreRenders component view.\r\n   * @returns {object} {fragment, elements...}\r\n   */\r\n  preRender() {\r\n    console.log(this.name + '.preRender() in having ', this.state);\r\n    const prerendered = {};\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'layout-container',\r\n      classList: ['column'],\r\n    });\r\n\r\n    const mainSection = dom.createElement({\r\n      tag: 'main',\r\n      id: 'layout-main',\r\n      // classList: ['shaded-content-container', 'column'],\r\n    });\r\n\r\n    prerendered.main = mainSection;\r\n\r\n    dom.setChildren(container, [ dom.createElement({\r\n      tag: 'header',\r\n      innerHTML: `<div class=\"layout-optimal-width-container layout-row layout-header\">\r\n          <div id=\"layout-logo\" class=\"layout-abs-center\" title=\"Pizza Line logo\"></div>\r\n          <time id=\"layout-current-time\" class=\"layout-clock\" datetime=\"2018-01-31 00:00\">00:00:00</time>\r\n          <div id=\"layout-signout\">\r\n              <a href=\"#/logout\" class=\"layout-logout\">\r\n                  <i class=\"fas fa-user-secret\"></i>\r\n                  Sign Out\r\n              </a>\r\n          </div>\r\n        </div>`,\r\n    }), mainSection, dom.createElement({\r\n      tag: 'footer',\r\n      innerHTML: `<div>\r\n              <address class=\"layout-row\"><div id=\"office-address\">Kottans, Kottans Str.1</div>\r\n                  <div>tel: <a href=\"tel:57778887\">577-788-87</a></div>\r\n              </address>\r\n          </div>\r\n          <div class=\"layout-row\" id=\"copyright\">\r\n              <div>Pizza Manager</div> <div>&copy; <span id=\"copy-year\">2018</span></div>\r\n          </div>`,\r\n    })], node => {\r\n      console.log(this.name + '.preRender() has formed ', container , 'receiving', node);\r\n    });\r\n    prerendered.fragment = container;\r\n    console.log(this.name + '.preRender() out with ', prerendered);\r\n    return prerendered;\r\n  }\r\n}\r\n","import mod from './Layout.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport {Auth} from \"../../services/Auth\";\r\nimport './style.css';\r\n\r\n/**\r\n * Class representing user login.\r\n */\r\nexport default class Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    dom.bindHandlers(this, 'handleSubmitAction');\r\n    console.log('Login: ', this.props);\r\n  }\r\n\r\n  /**\r\n   * Renders component view.\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'login-container',\r\n      classList: ['shaded-content-container', 'column'],\r\n    });\r\n    container.addEventListener('submit', this.handleSubmitAction);\r\n    container.innerHTML = `<h2>Login</h2>\r\n    <div id=\"login-result\"></div>\r\n    <form id=\"login-form\" method=\"POST\" target=\"#/login\">\r\n      <div>\r\n        <input required type=\"text\" id=\"login-username\" name=\"login-username\" \r\n            minlength=\"2\" maxlength=\"24\" inputmode=\"verbatim\" placeholder=\"User name\" title=\"Type your user name in\" />\r\n        <label for=\"login-username\" class=\"validity\"></label>\r\n      </div>\r\n      <div>\r\n        <input required type=\"password\" id=\"login-password\" name=\"login-password\" \r\n            minlength=\"8\" maxlength=\"32\" inputmode=\"verbatim\" placeholder=\"Password\" title=\"Type your password in\" />\r\n        <label for=\"login-password\" class=\"validity\"></label>\r\n      </div>\r\n      <button type=\"submit\" id=\"login-submit\">Sign in!</button>\r\n    </form>\r\n    <a href=\"#${this.props.routeProps.routes.register.url}\">${this.props.routeProps.routes.register.name}</a>\r\n    <a href=\"#/${Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)}\">Random link</a>\r\n    `;\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Handles credentials submission.\r\n   * @param {Event} ev\r\n   */\r\n  handleSubmitAction(ev) {\r\n    ev.preventDefault();\r\n    let username, password;\r\n    [username, password] = [ ev.target.elements['login-username'].value.trim(),\r\n      ev.target.elements['login-password'].value.trim() ];\r\n    Auth.login(username, password).then(loginResult => {\r\n      this.resultMessage('Logged in successfully');\r\n      if (this.props.routeProps.navigateOnSuccessToMethod) {\r\n        setTimeout(() => {\r\n          this.props.routeProps.navigateOnSuccessToMethod(this.props.routeProps.navigateOnSuccessToRoute);\r\n        }, 1500);\r\n      }\r\n    }).catch(rejection => {\r\n      this.resultMessage(rejection.error, 'error');\r\n      // clean up inputs and focus on username input\r\n      const els = ['login-username', 'login-password'].map(elId => document.getElementById(elId));\r\n      els.forEach(el => el.value = '');\r\n      els[0].focus();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Shows error or success message\r\n   * @param {string} message\r\n   * @param {string} type\r\n   */\r\n  resultMessage(message ='', type = 'success') {\r\n    const classToAdd = 'login-' + type;\r\n    const classToRemove = 'login-' + (type === 'success' ? 'error' : 'success');\r\n    const resultMessageElement = document.getElementById('login-result');\r\n    resultMessageElement.classList.remove(classToRemove);\r\n    resultMessageElement.classList.add(classToAdd);\r\n    resultMessageElement.innerHTML = message;\r\n  }\r\n\r\n}\r\n","import mod from './Login.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport {Auth} from \"../../services/Auth\";\r\n\r\n/**\r\n * Class representing user logout.\r\n */\r\nexport default class Logout extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    dom.bindHandlers(this, 'handleLogoutAction');\r\n  }\r\n\r\n  /**\r\n   * Renders component view.\r\n   * @returns {HTMLElement|string}\r\n   */\r\n  render() {\r\n    this.handleLogoutAction();\r\n    return '';\r\n    /*\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'logout-container',\r\n    });\r\n    container.addEventListener('click', this.handleLogoutAction);\r\n    container.innerHTML = `<a href=\"#/logout\">Sign out</a>`;\r\n    return container; */\r\n  }\r\n\r\n  /**\r\n   * Handles logout user action.\r\n   * @param {Event} ev\r\n   */\r\n  handleLogoutAction(ev = null) {\r\n    ev && ev.preventDefault();\r\n    Auth.logout();\r\n    if (this.props.routeProps.navigateOnSuccessToMethod) {\r\n      this.props.routeProps.navigateOnSuccessToMethod(this.props.routeProps.navigateOnSuccessToRoute);\r\n    }\r\n  }\r\n}\r\n","import mod from './Logout.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport './style.css';\r\nimport {Auth} from \"../../services/Auth\";\r\nimport {API} from \"../../services/API\";\r\n\r\n/**\r\n * Class representing user registration.\r\n */\r\nexport default class Register extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    dom.bindHandlers(this, 'handleDefaultSubmitAction', 'handleRealSubmitAction', 'handlePasswordsMatch', 'handleRealSubmitAction');\r\n    console.log('Register', this.props);\r\n  }\r\n\r\n  /**\r\n   * Renders component view\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'register-container',\r\n      classList: ['shaded-content-container', 'column'],\r\n    });\r\n    container.addEventListener('submit', this.handleDefaultSubmitAction);\r\n    dom.setChildren(container, `<h2>Register</h2>\r\n    <div id=\"register-result\"></div>\r\n    <form id=\"register-form\" method=\"POST\" target=\"#/login\">\r\n      <div>\r\n        <input required type=\"text\" id=\"register-username\" name=\"register-username\" \r\n            minlength=\"2\" maxlength=\"24\" inputmode=\"verbatim\" placeholder=\"User name\" title=\"Type your user name in\" />\r\n        <label for=\"register-username\" class=\"validity\"></label>\r\n      </div>\r\n      <div>\r\n        <input required type=\"password\" id=\"register-password1\" name=\"register-password1\" \r\n            minlength=\"8\" maxlength=\"32\" inputmode=\"verbatim\" placeholder=\"Password\" title=\"Type your password in\" />\r\n        <label for=\"register-password1\" class=\"validity\"></label>\r\n      </div>\r\n      <div>\r\n        <input required type=\"password\" id=\"register-password2\" name=\"register-password2\" \r\n            minlength=\"6\" maxlength=\"32\" inputmode=\"verbatim\" placeholder=\"Password once again\" title=\"Type your password in once again\" />\r\n        <label for=\"register-password2\" class=\"validity\"></label>\r\n      </div>\r\n      <div>\r\n        <input required type=\"email\" id=\"register-email\" name=\"register-email\" \r\n            minlength=\"8\" maxlength=\"32\" inputmode=\"email\" placeholder=\"E-mail\" title=\"Type your e-mail in\" />\r\n        <label for=\"register-email\" class=\"validity\"></label>\r\n      </div>\r\n      <div id=\"register-store\">\r\n        <label for=\"register-store_id\"><strong>Store:</strong> </label>\r\n        <SELECT required id=\"register-store_id\">\r\n        </SELECT>\r\n      </div>\r\n      <div>\r\n        <input required type=\"password\" id=\"register-store_password\" name=\"register-store_password\" \r\n            minlength=\"8\" maxlength=\"32\" inputmode=\"verbatim\" placeholder=\"Store password\" title=\"Type password for selected store\" />\r\n        <label for=\"register-store_password\" class=\"validity\"></label>\r\n      </div>\r\n      <button type=\"button\" class=\"real-submit\" id=\"register-real-submit\" disabled>Sign up!</button>\r\n      <button type=\"submit\" class=\"register-hidden\" id=\"register-default-submit\">You should not see me</button>\r\n    </form>\r\n    <div>Have already got an account?</div>\r\n    <a href=\"#${this.props.routeProps.routes.login.url}\">${this.props.routeProps.routes.login.name}</a>\r\n    <hr/>\r\n    <a href=\"#/${Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)}\">Random link</a>\r\n    `, node => {\r\n      document.getElementById('register-username').addEventListener('input', this.handleDefaultSubmitAction);\r\n      document.getElementById('register-email').addEventListener('input', this.handleDefaultSubmitAction);\r\n      document.getElementById('register-store_password').addEventListener('input', this.handleDefaultSubmitAction);\r\n      document.getElementById('register-password1').addEventListener('input', this.handleDefaultSubmitAction);\r\n      document.getElementById('register-password2').addEventListener('input', this.handleDefaultSubmitAction);\r\n\r\n      document.getElementById('register-password1').addEventListener('input', this.handlePasswordsMatch);\r\n      document.getElementById('register-password2').addEventListener('input', this.handlePasswordsMatch);\r\n      document.getElementById('register-real-submit').addEventListener('click', this.handleRealSubmitAction);\r\n      const storeSelectElement = document.getElementById('register-store_id');\r\n      Auth.getStoreList().then(result => {\r\n        this.resultMessage(); // clean up result state\r\n        result.list.sort((a, b) => a.name.toUpperCase() > b.name.toUpperCase() ? 1 : -1).forEach(item => {\r\n          const option = document.createElement('option');\r\n          option.text = item.name;\r\n          option.value = item.id;\r\n          storeSelectElement.options.add(option);\r\n        });\r\n      }).catch(rejection => {\r\n        if (rejection.serverError) {\r\n          const errorUIelement = document.getElementById('register-store');\r\n          errorUIelement.classList.add('alert');\r\n          errorUIelement.innerHTML = `<p>Pizza server may be down or API has changed.</p> \r\n              <p>Please, <a href=\"${window.location}\">try again later</a> or</p>\r\n              <p>contact pizza server admin at <a href=\"${API.APIOwner}\">${API.APIOwner}</a>.</p>\r\n              <p>Server responded: ${rejection.error}</p>`;\r\n        } else {\r\n          this.resultMessage(rejection.error, 'error');\r\n        }\r\n\r\n      })\r\n    });\r\n    // console.log('Register.render()');\r\n    // console.log(container);\r\n    return container;\r\n  }\r\n\r\n  /**\r\n   * Handles default form submission to activate native validations\r\n   * @param {Event} ev\r\n   */\r\n  handleDefaultSubmitAction(ev) {\r\n    ev.preventDefault();\r\n    let enableSubmission = document.getElementById('register-form').checkValidity();\r\n    if (document.getElementById('register-password1').value !== document.getElementById('register-password2').value) {\r\n      enableSubmission = false;\r\n    }\r\n    const submitButton = document.getElementById('register-real-submit');\r\n    if (enableSubmission) {\r\n      submitButton.removeAttribute('disabled');\r\n    } else {\r\n      submitButton.setAttribute('disabled', 'true');\r\n    }\r\n    // console.log(this.name + ': handleDefaultSubmitAction()', ev.target, ev);\r\n  }\r\n\r\n  /**\r\n   * Handles 2nd password input and its match with 1st password\r\n   * @param {Event} ev\r\n   */\r\n  handlePasswordsMatch(ev) {\r\n    const pwd1 = document.getElementById('register-password1');\r\n    const pwd2 = document.getElementById('register-password2');\r\n    if (pwd2.value.length) {\r\n      pwd2.setCustomValidity(pwd1.value === pwd2.value ? \"\" : \"Both passwords should match\");\r\n      document.getElementById('register-default-submit').click();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handles registration submission\r\n   * @param {Event} ev\r\n   */\r\n  handleRealSubmitAction(ev) {\r\n    ev.preventDefault();\r\n    if (!document.getElementById('register-form').reportValidity()) return;\r\n    let fields = {};\r\n    ['register-username', 'register-password1', 'register-password2', 'register-email', 'register-store_id', 'register-store_password'].forEach(name => {\r\n      fields[name.split('-').slice(1).join('-')] = document.getElementById(name).value.trim()\r\n    });\r\n    fields.store_id = parseInt(fields.store_id);\r\n\r\n    console.log(this.name + ': Submit action invoked with credentials: ', fields);\r\n\r\n    Auth.register(fields.username, fields.password1, fields.password2, fields.email, fields.store_id, fields.store_password).then( registerResult => {\r\n      this.resultMessage('Registered successfully');\r\n      console.log('Register.handleRealSubmitAction() registered OK', this.props);\r\n      if (this.props.routeProps.navigateOnSuccessToMethod) {\r\n        setTimeout(() => {\r\n          this.props.routeProps.navigateOnSuccessToMethod(this.props.routeProps.navigateOnSuccessToRoute, 'Registered successfully', 'success');\r\n        }, 1500);\r\n      }\r\n    }).catch(rejection => {\r\n      console.log('Register.handleSubmitAction() rejected: ', rejection);\r\n      this.resultMessage(rejection.error + (rejection.validations ? '<div>' + rejection.validations.join('</div><div>') + '</div>' : ''), 'error');\r\n      // clean up inputs and focus on username input\r\n      const els = ['register-username', 'register-password1', 'register-password2', 'register-email', 'register-store_password'].map(elId => document.getElementById(elId));\r\n      els.forEach(el => el.value = '');\r\n      els[0].focus();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Shows error or success message\r\n   * @param {string} message\r\n   * @param {string} type\r\n   */\r\n  resultMessage(message ='', type = 'success') {\r\n    const classToAdd = 'register-' + type;\r\n    const classToRemove = 'register-' + (type === 'success' ? 'error' : 'success');\r\n    const resultMessageElement = document.getElementById('register-result');\r\n    resultMessageElement.classList.remove(classToRemove);\r\n    resultMessageElement.classList.add(classToAdd);\r\n    resultMessageElement.innerHTML = message;\r\n  }\r\n}\r\n","import mod from './Register.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport * as Obj from '../../utils/object.js';\r\n\r\n/**\r\n * Class representing app secret page.\r\n */\r\nexport default class Secret extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    console.log(this.name);\r\n    console.log(this.props);\r\n  }\r\n\r\n  /**\r\n   * Renders component view\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'secret-container',\r\n      classList: ['shaded-content-container', 'column'],\r\n    });\r\n\r\n    const links = Obj.map(this.props.routeProps.routes, ({url, name}, routeName) => {\r\n      if (url.search(':id') >= 0 ) {\r\n        url = url.replace(':id', Math.floor(Math.random() * 100) + 1);\r\n      }\r\n      return `<a href=\"#${url}\">${name}</a>`\r\n    });\r\n\r\n    container.innerHTML = '<h2>Secret place</h2>' +\r\n        '<p>Kinda 404, you know...</p>' +\r\n        '<p>You do not belong here! Navigate away!</p>' +\r\n        '<div>' + links.join('</div><div>') + '</div>';\r\n    return container;\r\n  }\r\n}\r\n","import mod from './Secret.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport * as Obj from \"../../utils/object\";\r\n\r\n/**\r\n * Class representing particular order.\r\n */\r\nexport default class Order extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      id: this.props.params.id,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'order-container',\r\n      classList: ['shaded-content-container', 'column'],\r\n    });\r\n\r\n    container.innerHTML = `<h2>Order #${this.state.id}</h2>\r\n      <a href=\"#/order/${Math.floor(Math.random()*100)+1}\">Random order</a>\r\n      <hr/>\r\n      <a href=\"#/\">Home</a>\r\n      <a href=\"#/${Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)}\">Random link</a>`;\r\n    return container;\r\n  }\r\n}\r\n","import mod from './Order.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport './style.css';\r\n\r\n/**\r\n * Class representing orders list.\r\n */\r\nexport default class Orders extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      id: props.id,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    console.log(this.name +'.render() in having this.host', this.host);\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'orders-container',\r\n      classList: ['column'],\r\n    });\r\n\r\n    container.innerHTML = `\r\n      <a href=\"#/add\" class=\"orders-addpizza\"><i class=\"fas fa-plus\"></i></a>\r\n      <h2>No pizzas yet in the queue. Add one by clicking (+) below</h2>\r\n      <!-- h2>Current orders</h2>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cccccc</div>\r\n      <div>cc1cccc</div>\r\n      <div>cc2cccc</div>\r\n      <div>cc3cccc</div>\r\n      <div>ccc4ccc</div>\r\n      <div>cccc5cc</div>\r\n      <div>ccccc6c</div>\r\n      <div>cccccc7</div>\r\n      <div>cc8cccc</div>\r\n      <div>ccc9ccc</div>\r\n      <div>cccccca</div>\r\n      <div>ccccccb</div>\r\n      <div>ccccccc</div>\r\n      <div>ccccccd</div>\r\n      <div>cccccce</div>\r\n      <div>ccccccf</div>\r\n      <div>ccccccg</div>\r\n      <div>cccccch</div>\r\n      <div>cccccci</div>\r\n      <div>ccccccj</div>\r\n      <div>cccccck</div>\r\n      <div>ccccccl</div>\r\n      <div>ccccccm</div>\r\n      <div>ccccccn</div>\r\n      <div>cccccco</div>\r\n      <div>ccccccp</div>\r\n      <div>ccccccq</div>\r\n      <div>ccccccr</div>\r\n      <div>ccccccs</div>\r\n      <div>cccccct</div>\r\n      <div>ccccccu</div>\r\n      <div>ccccccv</div>\r\n      <div>ccccccw</div>\r\n      <div>ccccccx</div>\r\n      <div>ccccccy</div>\r\n      <div>ccccccz</div>\r\n      <div>cccccczz</div>\r\n      <div>ccccccz2</div>\r\n      <div>ccccccz3</div>\r\n      <div>cc1cccc</div>\r\n      <div>cc2cccc</div>\r\n      <div>cc3cccc</div>\r\n      <div>ccc4ccc</div>\r\n      <div>cccc5cc</div>\r\n      <div>ccccc6c</div>\r\n      <div>cccccc7</div>\r\n      <div>cc8cccc</div>\r\n      <div>ccc9ccc</div>\r\n      <div>cccccca</div>\r\n      <div>ccccccb</div>\r\n      <div>ccccccc</div>\r\n      <div>ccccccd</div>\r\n      <div>cccccce</div>\r\n      <div>ccccccf</div>\r\n      <div>ccccccg</div>\r\n      <div>cccccch</div>\r\n      <div>cccccci</div>\r\n      <div>ccccccj</div>\r\n      <div>cccccck</div>\r\n      <div>ccccccl</div>\r\n      <div>ccccccm</div>\r\n      <div>ccccccn</div>\r\n      <div>cccccco</div>\r\n      <div>ccccccp</div>\r\n      <div>ccccccq</div>\r\n      <div>ccccccr</div>\r\n      <div>ccccccs</div>\r\n      <div>cccccct</div>\r\n      <div>ccccccu</div>\r\n      <div>ccccccv</div>\r\n      <div>ccccccw</div>\r\n      <div>ccccccx</div>\r\n      <div>ccccccy</div>\r\n      <div>ccccccz</div>\r\n      <div>cccccczz</div>\r\n      <div>ccccccz2</div>\r\n      <div>ccccccz3</div -->\r\n      <a href=\"#/order/${Math.floor(Math.random()*100)+1}\">Random order</a>\r\n      <hr/>\r\n      <a href=\"#/\">Home</a>\r\n      <a href=\"#/${Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)}\">Random link</a>`;\r\n    console.log(this.name +'.render() out returning', container);\r\n    return container;\r\n  }\r\n}\r\n","import mod from './Orders.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport * as dom from '../../utils/dom.js';\r\nimport {Auth} from '../../services/Auth';\r\nimport './style.css';\r\n\r\nconst PIZZA_SIZES = [30, 45, 60];\r\n\r\n/**\r\n * Class representing pizza constructor.\r\n */\r\nexport default class PizzaParams extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    console.log('PizzaParams constructor; state', this.state);\r\n    dom.bindHandlers(this, 'handleUserAction', 'handleSubmit');\r\n    this.prerendered = this.preRender();\r\n  }\r\n\r\n  /**\r\n   * Supplies state to caller's context\r\n   */\r\n  handleUserAction(ev) {\r\n    console.log(this.name + '.onUserAction() in with event', ev, 'and state', this.state);\r\n    const trackedParams = ['pizza-size', 'pizza-ingredient']; // , 'pizza-tag'];\r\n    const target = ev.target;\r\n    let doUpdate = false;\r\n    if (trackedParams.includes(target.name)) {\r\n      console.log(this.name + '.onUserAction() event on tracked item', target);\r\n      switch (target.name) {\r\n        case 'pizza-size': this.state.size = parseInt(target.value); break;\r\n        case 'pizza-ingredient':\r\n          if (target.checked) {\r\n            this.state.ingredients[target.value] = target.value;\r\n          } else {\r\n            delete this.state.ingredients[target.value];\r\n          }\r\n          break;\r\n        /* case 'pizza-tag':\r\n          if (target.checked) {\r\n            this.state.tags[target.value] = target.value;\r\n          } else {\r\n            delete this.state.tags[target.value];\r\n          }\r\n          break; */\r\n      }\r\n      doUpdate = true;\r\n    }\r\n\r\n    console.log(this.name + '.onUserAction() about to out with state', this.state);\r\n    if (doUpdate) {\r\n      this.props.onParamsChange(this.state);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Manages submit action\r\n   */\r\n  handleSubmit(ev) {\r\n    ev.preventDefault();\r\n    console.log(this.name + '.onSubmit()', ev, 'and state', this.state);\r\n  }\r\n\r\n  /**\r\n   * Render view\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    return this.prerendered.fragment;\r\n  }\r\n\r\n  /**\r\n   * PreRenders component view.\r\n   * @returns {object} {fragment, elements...}\r\n   */\r\n  preRender() {\r\n    console.log(this.name + '.preRender() in having ', this.state);\r\n    const container = dom.createElement({\r\n      tag: 'form',\r\n      id: 'pizzaConstructor-container',\r\n      classList: ['pizzaParams-container'],\r\n    });\r\n\r\n    container.addEventListener('change', this.handleUserAction);\r\n    container.addEventListener('submit', this.handleSubmit);\r\n\r\n    const checkedSizeValue = this._getPizzaSizeCheckedArray();\r\n    const pizzaSizeRadios = '<fieldset><legend>Size</legend>' + PIZZA_SIZES.reduce((html, size, idx) => html + `\r\n      <input type=\"radio\" id=\"pizza-size-${idx}\" name=\"pizza-size\" value=\"${size}\"${checkedSizeValue[size]}>\r\n      <label for=\"pizza-size-${idx}\">${size}</label>\r\n    `, '') + '</fieldset>';\r\n    container.innerHTML =  '<input required type=\"text\" id=\"pizza-name\" value=\"' + this.state.name + '\" placeholder=\"Pizza order name\">' +\r\n      '<textarea id=\"pizza-description\" placeholder=\"Pizza description\">' + this.state.description + '</textarea>' +\r\n      pizzaSizeRadios;\r\n    const sets = ['ingredient', 'tag'];\r\n    Promise.all([Auth.getIngredients(), Auth.getTags()])\r\n      .then(list => {\r\n        console.log(this.name + '.preRender()', list);\r\n        for (let i = 0; i < 2; ++i) {\r\n          const el = dom.createElement('fieldset');\r\n          el.innerHTML = '<legend>' + sets[i] + '</legend>' +\r\n            list[i].reduce((html, item) => html + `<input type=\"checkbox\" id=\"pizza-${sets[i]}-${item.id}\" name=\"pizza-${sets[i]}\" value=\"${item.name}\">\r\n            <label for=\"pizza-${sets[i]}-${item.id}\">${item.description}</label>`,\r\n            '');\r\n          container.appendChild(el);\r\n        }\r\n        container.appendChild(dom.createElement({\r\n          tag: 'button',\r\n          // attr: {type: 'button'},\r\n          innerHTML: 'Submit',\r\n        }));\r\n        container.appendChild(dom.createElement({\r\n          tag: 'button',\r\n          attr: {type: 'button'},\r\n          innerHTML: 'Cancel',\r\n          classList: 'alert-background',\r\n        }));\r\n      });\r\n\r\n    /* const canvas = dom.createElement('canvas');\r\n    const params = dom.createElement('div');\r\n\r\n    dom.setChildren(container, [ canvas, params ]); */\r\n\r\n    return {\r\n      fragment: container,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Returns array of checked state per each size\r\n   * @returns {Array}\r\n   * @private\r\n   */\r\n  _getPizzaSizeCheckedArray() {\r\n    const checkedSize = [];\r\n    for (let i = PIZZA_SIZES.length - 1; i >= 0; --i) {\r\n      checkedSize[PIZZA_SIZES[i]] = '';\r\n    }\r\n    checkedSize[this.state.size] = ' CHECKED';\r\n    return checkedSize;\r\n  }\r\n\r\n}\r\n","import mod from './PizzaParams.js';\r\nexport default mod;\r\n","import {API} from '../API';\r\nimport {Auth} from '../Auth';\r\n\r\n/**\r\n * Supplies pizza-related images\r\n */\r\nclass PizzaImageryService {\r\n  constructor() {\r\n    this.images = {};\r\n    console.log('PizzaImageryService constructor');\r\n    this.loadIngredients().then(data => {\r\n      data.push({\r\n        name: 'pizza',\r\n        url: 'static/images/pizza.png',\r\n      });\r\n      return data;\r\n    }).then(list => {\r\n      console.log('PizzaImageryService constructor', list);\r\n      list.forEach(item => {\r\n        const image = new Image();\r\n        image.crossOrigin = '';\r\n        image.src = API.prependAssetUrl(item.url);\r\n        this.images[item.name] = Promise.resolve(image);\r\n      });\r\n      console.log('PizzaImageryService constructor images', this.images);\r\n    }).catch(rejection => console.log('PizzaImageryService.constructor() error', rejection));\r\n  }\r\n\r\n  /**\r\n   * Returns cached image\r\n   * @param imageName\r\n   * @returns {Image}\r\n   */\r\n  getImage(imageName) {\r\n    return this.images[imageName] || Promise.reject('no-data');\r\n  }\r\n\r\n  loadIngredients() {\r\n    return Auth.getIngredients().then(data => data.map(item => ({\r\n      name: item.name,\r\n      url: item.image_url,\r\n    }))).catch(rejection => console.log('PizzaImageryService.loadIngredients() error', rejection));\r\n  }\r\n}\r\n\r\nexport const PizzaImagery = new PizzaImageryService();\r\n","export { PizzaImagery } from './PizzaImagery.js';\r\n","export const CANVAS = {\r\n  px: {\r\n    width: 320,\r\n    height: 320,\r\n  },\r\n  inch: {\r\n    width: 60,\r\n    height: 60,\r\n  },\r\n  pxInch: 0, // pixels per inch\r\n  ingredient: {\r\n    width: 20,\r\n    height: 20,\r\n  },\r\n  areas: {\r\n    30: {\r\n      maxRadius: 0, // max px radius allowed\r\n      nodes: [], // nodes list of {r, asimuth}...\r\n      maxIngredients: 14, // max ingredients allowed\r\n    },\r\n    45: {\r\n      maxRadius: 0,\r\n      nodes: [],\r\n      maxIngredients: 14,\r\n    },\r\n    60: {\r\n      maxRadius: 0,\r\n      nodes: [],\r\n      maxIngredients: 14,\r\n    },\r\n  }\r\n};\r\nCANVAS['pxInch'] = Math.floor(CANVAS.px.width / CANVAS.inch.width);\r\nCANVAS.center = {\r\n  x: Math.floor(CANVAS.px.width / 2),\r\n  y: Math.floor(CANVAS.px.height / 2),\r\n};\r\nObject.keys(CANVAS.areas).forEach(r => {\r\n  CANVAS.areas[r].maxRadius = Math.round(r * CANVAS.pxInch / 2 - r / 3 - 5);\r\n});\r\n\r\n/* Build nodes (placeholders) for every radius at step 10px\r\n At r=150 degreeStep=10deg\r\n At r=5 degreeStep=45deg\r\n */\r\nconst targetR = CANVAS.pxInch * CANVAS.inch.height;\r\nconst radii = Object.keys(CANVAS.areas);\r\nconst nodes = {\r\n  30: [],\r\n  45: [],\r\n  60: [],\r\n};\r\n\r\nfor(let r = 10; r < targetR; r += 10) {\r\n  const itemsOnCircle = Math.floor(Math.PI * 2 * r / (CANVAS.ingredient.width * 1.6));\r\n  const degStep = 360 / itemsOnCircle;\r\n  for(let deg = 0; deg < 360; deg += degStep * 0.7) {\r\n    const pair = {\r\n      r: r + (-Math.random() * 4 + 3),\r\n      asimuth: deg + (-Math.random() * 15 + 7.5),\r\n    };\r\n    radii.forEach(inches => {\r\n      if (CANVAS.areas[inches].maxRadius > r) {\r\n        nodes[inches].push(pair);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n// copy nodes to CANVAS\r\nradii.forEach(inches => {\r\n  CANVAS.areas[inches].nodes = nodes[inches];\r\n});\r\n\r\n/* For each area distribute nodes evenly across maxIngredients node subsets\r\n   When drawing choose subset wisely.\r\n   Given 12 subsets use those dep on ingredients count:\r\n   1: 0\r\n   2: 0, 6\r\n   3: 0, 4, 8\r\n   4: 0, 3, 6, 9\r\n   5: 0, 2, 5, 7, 10 -- i.e. every round(12/n)\r\n*/\r\n/*\r\nradii.forEach(inches => {\r\n  const maxIngredients = CANVAS.areas[inches].maxIngredients;\r\n  const len = nodes[inches].length;\r\n  const times = Math.ceil(len / maxIngredients);\r\n  for (let i = 0; i < maxIngredients; i++) {\r\n    CANVAS.areas[inches].nodes[i] = [];\r\n    for (let j = 0; j < times; j++) {\r\n      if (j*maxIngredients+i < len) {\r\n        CANVAS.areas[inches].nodes[i].push(nodes[inches][j*maxIngredients+i]);\r\n      }\r\n    }\r\n  }\r\n}); */\r\n\r\n/* In the end of the day we draw\r\n   per each .areas[]\r\n   .areas[].maxIngredients ingredients\r\n   each .areas[].ingredientInstancesPerArea times\r\n   at .areas[].nodes[]\r\n   max .areas[].length sprites\r\n */\r\n\r\n// console.log('CANVAS SETTINGS', CANVAS);\r\n","import Component from '../../Component';\r\nimport {PizzaImagery} from \"../../services/PizzaImagery\";\r\nimport {CANVAS} from './settings';\r\n\r\n/**\r\n * Class representing pizza constructed image.\r\n * host is a <canvas> element\r\n */\r\nexport default class PizzaCanvas extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.ctx = this.host.getContext(\"2d\");\r\n\r\n    this.host.width = CANVAS.px.width;\r\n    this.host.height = CANVAS.px.height;\r\n  }\r\n\r\n  /**\r\n   * Render view\r\n   * @returns {HTMLElement|string}\r\n   */\r\n  render() {\r\n    this.ctx.clearRect(0, 0, CANVAS.px.width, CANVAS.px.height);\r\n    // this.ctx.fillRect(10,10,150,150);\r\n    console.log(this.name + '.render() state', this.state);\r\n    this.drawPizzaBase();\r\n    this.drawIngredients();\r\n    return '';\r\n  }\r\n\r\n  /**\r\n   * Draws ingredients\r\n   */\r\n  drawIngredients() {\r\n    const area = CANVAS.areas[this.state.size];\r\n    console.log(this.name + '.drawIngredients() area', area);\r\n\r\n    const ingredientsCount = Object.keys(this.state.ingredients).length;\r\n\r\n    const nodes = this._distributeNodesEvenly(area.nodes, ingredientsCount);\r\n\r\n    Object.keys(this.state.ingredients).forEach((item, idx) => {\r\n      PizzaImagery.getImage(item)\r\n        .then(image => {\r\n          const coordSet = nodes[idx];\r\n          for(let i = coordSet.length - 1; i >= 0; i--) {\r\n            const polar = coordSet[i];\r\n            this._drawImage(image, polar.r, polar.asimuth, CANVAS.ingredient.width, CANVAS.ingredient.height);\r\n          }\r\n        })\r\n        .catch(rejection => console.log(this.name + '.drawIngredients() REJECTED', rejection));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Distributes array of nodes evenly across count groups\r\n   * @param {array} nodes [{r,asimuth}...]\r\n   * @param {number} count\r\n   * @returns {array} [[{r,asimuth}...]...]\r\n   * @private\r\n   */\r\n  _distributeNodesEvenly(nodes, count) {\r\n    const groupedNodes = [];\r\n    const len = nodes.length;\r\n    const times = Math.ceil(len / count);\r\n    for (let i = 0; i < count; i++) {\r\n      groupedNodes[i] = [];\r\n      for (let j = 0; j < times; j++) {\r\n        if (j*count+i < len) {\r\n          groupedNodes[i].push(nodes[j*count+i]);\r\n        }\r\n      }\r\n    }\r\n    return groupedNodes;\r\n  }\r\n\r\n  /**\r\n   * Draws scaled pizza base\r\n   */\r\n  drawPizzaBase() {\r\n    PizzaImagery.getImage('pizza')\r\n      .then(image => {\r\n        const pxDimension = this.state.size * CANVAS.pxInch;\r\n        image.width = pxDimension;\r\n        image.height = pxDimension;\r\n        console.log(this.name + '.drawPizzaBase()', image);\r\n        this._drawImage(image, 0, 0, pxDimension, pxDimension);\r\n        /* const img = new Image(pxDimension, pxDimension);\r\n        img.src = image.src;\r\n        img.onload = () => this.ctx.drawImage(img, 0, 0); */\r\n      })\r\n      .catch(rejection => console.log(this.name + '.drawPizzaBase() REJECTED', rejection));\r\n  }\r\n\r\n  /**\r\n   * Draws an image where its center is in polar coordinates (r,azimuth)\r\n   * @param {HTMLimageElement} image\r\n   * @param {number} r\r\n   * @param {number} azimuth\r\n   * @param {number} width\r\n   * @param {number} height\r\n   * @private\r\n   */\r\n  _drawImage(image, r, azimuth, width=0, height=0) {\r\n    if (!width) width = image.width;\r\n    if (!height) height = image.height;\r\n    const dx = -Math.round(width / 2);\r\n    const dy = -Math.round(height / 2);\r\n    const realCoordinates = this._polar2carthesian(r, azimuth);\r\n    this.ctx.drawImage(image, realCoordinates.x + dx, realCoordinates.y + dy, width, height);\r\n  }\r\n\r\n  /**\r\n   * Converts polar coordinates\r\n   * @param {number} r\r\n   * @param {number} azimuth\r\n   * @returns {object} {x,y} ready to draw at, based on CANVAS settings\r\n   * @private\r\n   */\r\n  _polar2carthesian(r, azimuth) {\r\n    const radians = azimuth * Math.PI / 180;\r\n    const x = Math.round(r * Math.cos(radians) + CANVAS.center.x);\r\n    const y = Math.round(-r * Math.sin(radians) + CANVAS.center.y);\r\n    return { x, y };\r\n  }\r\n}\r\n","import mod from './PizzaCanvas.js';\r\nexport default mod;\r\n","import Component from '../../Component';\r\nimport PizzaParams from '../PizzaParams';\r\nimport PizzaCanvas from '../PizzaCanvas';\r\nimport * as dom from '../../utils/dom.js';\r\nimport './style.css';\r\n\r\n/**\r\n * Class representing particular order.\r\n */\r\nexport default class PizzaEditor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    };\r\n    dom.bindHandlers(this, 'onParamsChange');\r\n    this.prerendered = this.preRender();\r\n    const pizzaInitialState = {\r\n      size: 60,\r\n      ingredients: {},\r\n      tags: {},\r\n      name: '',\r\n      description: '',\r\n    };\r\n    this.children = {\r\n      pizzaCanvas: new PizzaCanvas({\r\n        host: this.prerendered.canvas,\r\n        state: pizzaInitialState,\r\n      }),\r\n      pizzaConstructor: new PizzaParams({\r\n        host: this.prerendered.params,\r\n        onParamsChange: this.onParamsChange,\r\n        state: pizzaInitialState,\r\n      }),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Updates pizzaCanvas when pizza params changed within pizzaConstructor\r\n   * @param {object} state\r\n   */\r\n  onParamsChange(state) {\r\n    this.children.pizzaCanvas.updateState(state);\r\n  }\r\n\r\n  /**\r\n   * Called within Component workflow\r\n   */\r\n  updateChildrenState() {\r\n    this.children.pizzaConstructor.updateState();\r\n    this.children.pizzaCanvas.updateState();\r\n  }\r\n\r\n  /**\r\n   * Render view\r\n   * @returns {HTMLElement}\r\n   */\r\n  render() {\r\n    return this.prerendered.fragment;\r\n  }\r\n\r\n  /**\r\n   * PreRenders component view.\r\n   * @returns {object} {fragment, elements...}\r\n   */\r\n  preRender() {\r\n    console.log(this.name + '.preRender() in having ', this.state);\r\n    const container = dom.createElement({\r\n      tag: 'div',\r\n      id: 'pizzaEditor-container',\r\n      classList: ['row-wrap'],\r\n    });\r\n\r\n    const canvas = dom.createElement('canvas');\r\n    const canvasContainer = dom.createElement({\r\n      tag: 'div',\r\n      classList: ['pizzaEditor-canvas'],\r\n    });\r\n    canvasContainer.appendChild(canvas);\r\n    const params = dom.createElement({\r\n      tag: 'div',\r\n      classList: ['pizzaEditor-params'],\r\n    });\r\n\r\n    dom.setChildren(container, [ canvasContainer, params ]);\r\n\r\n    return {\r\n      fragment: container,\r\n      canvas: canvas,\r\n      params: params,\r\n    };\r\n  }\r\n\r\n}\r\n","import mod from './PizzaEditor.js';\r\nexport default mod;\r\n","import Login from './components/Login';\r\nimport Logout from './components/Logout';\r\nimport Register from './components/Register';\r\nimport Secret from './components/Secret';\r\nimport Order from './components/Order';\r\nimport Orders from './components/Orders';\r\nimport PizzaEditor from './components/PizzaEditor';\r\n\r\nexport const routes = {\r\n  none: {\r\n    url: '',\r\n    redirectToRoute: 'home',\r\n  },\r\n  home: {\r\n    name: 'Home',\r\n    url: '/',\r\n    redirectUnauthorizedToRoute: 'login',\r\n    redirectAuthorizedToRoute: 'orders',\r\n  },\r\n  login: {\r\n    name: 'Sign in',\r\n    url: '/login',\r\n    component: Login,\r\n    navigateOnSuccessToRoute: 'orders',\r\n    routes: ['register'], // router will xform [routeName1,...] to {routeName1:{name:,url:},..}\r\n  },\r\n  logout: {\r\n    name: 'Sign out',\r\n    url: '/logout',\r\n    component: Logout,\r\n    navigateOnSuccessToRoute: 'login',\r\n  },\r\n  register: {\r\n    name: 'Register',\r\n    url: '/register',\r\n    component: Register,\r\n    navigateOnSuccessToRoute: 'login',\r\n    routes: ['login'],\r\n  },\r\n  orders: {\r\n    name: 'Orders queue',\r\n    url: '/orders',\r\n    redirectUnauthorizedToRoute: 'login',\r\n    layout: true, // use Layout component\r\n    component: Orders,\r\n  },\r\n  order: {\r\n    name: 'Pizza',\r\n    url: '/order/:id',\r\n    redirectUnauthorizedToRoute: 'login',\r\n    component: Order,\r\n  },\r\n  add: {\r\n    name: 'Add pizza',\r\n    url: '/add',\r\n    redirectUnauthorizedToRoute: 'login',\r\n    layout: true, // use Layout component\r\n    component: PizzaEditor,\r\n  },\r\n  secret: {\r\n    url: '/secret',\r\n    component: Secret,\r\n    routes: ['home', 'login', 'register', 'orders', 'order', 'add'],\r\n  },\r\n};\r\n\r\nexport const defaultRoute = 'secret';\r\n","import Router from './components/Router';\r\nimport Layout from './components/Layout';\r\nimport * as routingConfig from './routes.js';\r\n\r\nconst rootHost = document.getElementById(document.getElementById('entry-script').getAttribute('data-app-container'));\r\n\r\nwindow.router = new Router({\r\n  host: rootHost,\r\n  routes: routingConfig.routes,\r\n  defaultRoute: routingConfig.defaultRoute,\r\n  layoutManager: new Layout({\r\n    host: rootHost,\r\n  }),\r\n});\r\n"]}